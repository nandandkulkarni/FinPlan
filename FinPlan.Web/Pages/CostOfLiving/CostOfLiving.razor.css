/* ----------------------------
                                                                                                                                                   Tweakable values
                                                                                                                                                   - TAB_PANEL_TOP_OFFSET: how far the panel is pulled up under the tabs (negative pulls up)
                                                                                                                                                   - TAB_PANEL_PADDING_TOP: extra top padding inside the panel to avoid overlapping content
                                                                                                                                                   Adjust these values to fine tune the 'kiss' between tabs and panel.
                                                                                                                                                   ---------------------------- */
/* Example: change --tab-panel-top-offset to -8px or -4px to tweak */
/* CSS variables used below for convenience */
:root {
    --tab-panel-top-offset: -6px; /* Tweak this to move the panel up/down (more negative => more overlap) */
    --tab-panel-padding-top: 26px; /* Tweak this to add internal spacing at top if panel overlaps tabs */
}

.survey-card {
    border-right: 8px solid #1F6FEB !important;
    border-top: 1px solid #e9ecef;
    border-bottom: 1px solid #e9ecef;
    border-left: 1px solid #e9ecef;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(31,111,235,0.08);
    background: #fff;
}

.survey-card-narrow {
    width: 75%;
    min-width: 180px;
    max-width: 320px;
    margin-left: 0;
    margin-right: auto;
    align-self: flex-start;
}

/* Compact Mode Toggle Styles */
.form-switch .form-check-input {
    transition: all 0.2s ease;
}

    .form-switch .form-check-input:checked {
        background-color: #0d6efd;
        border-color: #0d6efd;
    }

    .form-switch .form-check-input:focus {
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.2);
    }

/* Large form switch for modal - 2x bigger */
.form-check-modal-lg .form-check-input {
    width: 4rem;
    height: 2rem;
}

.form-check-modal-lg .form-check-label {
    font-size: 1rem;
    font-weight: 600;
    margin-left: 0.75rem;
}

.modal-mode-toggle {
    padding: 0.5rem 1rem;
    background: rgba(13, 110, 253, 0.05);
    border: 1px solid rgba(13, 110, 253, 0.1);
    border-radius: 8px;
}


/* Add missing empty-state styles */
.empty-state {
    text-align: center;
    padding: 60px 20px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 10px;
}


.start-planning-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(1px);
    z-index: 20;
    pointer-events: none;
}

    .start-planning-overlay .empty-state {
        background: rgba(255, 255, 255, 0.95);
        border: 2px solid #FFD600;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        max-width: 500px;
        margin: 20px;
        border-radius: 12px;
        padding: 40px;
        pointer-events: auto; /* Ensure the overlay content is clickable */
    }
/* ensure tab row doesn't leave default bottom spacing */
/* .nav, .nav-tabs, .nav.nav-tabs.mb-3 {
                                                                        margin-bottom: 0 !important; /* override bootstrap utility margin */
padding-bottom: 0;
position: relative; /* allow stacking with panel box */
z-index: 100;
}
*/

/* Ensure navigation stays clickable */
/* .nav, .nav-tabs, .nav.nav-tabs.mb-3 {
                                                                        margin-bottom: 0 !important;
                                                                        padding-bottom: 0;
                                                                        position: relative;
                                                                        z-index: 200; /* Higher than overlay */
}

*/
/* Ensure the top navigation stays above the overlay */
.top-strip {
    position: relative;
    z-index: 1030; /* This matches your MainLayout z-index */
}
/* Blur and disable the tab navigation when overlay is active */
.nav-tabs.overlay-blur {
    filter: blur(2px);
    transition: filter 0.3s ease;
    pointer-events: none; /* This makes the tabs non-clickable */
    opacity: 0.7; /* Optional: reduce opacity to make it more obvious they're disabled */
}

.section-card {
    /* darker border for stronger separation from the background */
    border: 1px solid rgba(16,24,36,0.12);
    padding: 10px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    min-height: 92px;
    background: #fff;
}

    .section-card .actions {
        margin-top: auto; /* push to bottom of the card */
        display: flex;
        justify-content: flex-end;
        gap: 8px;
    }

/* Totals boxes - make clearly non-interactive */
.totals-box {
    cursor: default;
    user-select: none;
    box-shadow: none;
    border: none;
    border-left: 4px solid rgba(255, 255, 255, 0.4);
    border-right: 4px solid rgba(255, 255, 255, 0.4);
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px 12px 0 0;
    min-width: 180px;
    transition: none;
    background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), transparent);
}

    .totals-box:hover {
        transform: none;
    }

    .totals-box:active {
        transform: none;
    }

.totals-label {
    font-size: 0.85rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    opacity: 0.95;
    margin-bottom: 4px;
}

.totals-value {
    font-size: 1.75rem;
    font-weight: 700;
    line-height: 1.2;
}

/* Info icon in totals should be clearly clickable */
.totals-label .bi-info-circle {
    cursor: pointer;
    opacity: 0.9;
    transition: opacity 0.2s;
}

    .totals-label .bi-info-circle:hover {
        opacity: 1;
    }

.btn-edit {
    background: #1F6FEB; /* professional blue */
    color: #ffffff;
    border: 0;
    padding: 7px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    /* Force left alignment inside the .actions flex container */
    margin-right: auto;
    align-self: center; /* keep vertical centering in the flex row */
}


/* Ensure left sidebar navigation stays clickable */
.col-12.col-md-2 {
    position: relative;
    z-index: 150; /* Higher than overlay */
}



/* Panel that encloses everything below the tabs.
                                                                                                                                                   Use positioning (top) instead of negative margin to avoid layout gaps from surrounding elements.
                                                                                                                                                   Tweak the CSS variables above to adjust placement and padding. */
.tab-panel-box {
    border: 2px solid #C79A00; /* dark yellow border */
    border-radius: 8px; /* matches tab corner feel */
    padding: var(--tab-panel-padding-top) 18px 20px 18px; /* top padding controlled by variable */
    margin-top: 0; /* reset margin approach */
    top: var(--tab-panel-top-offset); /* pull panel up under tabs - adjust variable above */
    position: relative; /* enable top offset */
    background: #ffffff; /* panel background; adjust for dark theme if needed */
    box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    z-index: 10;
    /* ensure panel's top border isn't clipped by parent overflow */
    overflow: visible;
}

/* If using dark theme, slightly different background so border remains visible */
.dark-theme .tab-panel-box {
    background: #171717;
}

/* Ensure active tab renders above the panel */
.tab-item-active, .nav-link.tab-active-custom {
    position: relative;
    z-index: 30;
    margin-bottom: 0; /* prevent extra gap from tab element itself */
}

/* keep panel content visually aligned with rounded active tab */
.tab-active-custom {
    background-color: #FFD600 !important;
    color: #222 !important;
    font-weight: 600;
    border: 1px solid #FFD600 !important;
    border-bottom: none !important;
    border-radius: 8px 8px 0 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    transition: background 0.2s, color 0.2s;
}

.tab-item-active {
    background: #FFD600;
    border-radius: 8px 8px 0 0;
    padding: 4px 6px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

    .tab-item-active .nav-link {
        background: transparent !important;
        border: none !important;
        color: #222 !important;
        font-weight: 600;
        padding: 0.18rem 0.4rem;
    }

.grid-yellow-bg {
    background: transparent; /* remove yellow fill */
    border-radius: 0.75rem;
    border: 1px solid rgba(255,214,0,0.18); /* keep border as requested */
    box-shadow: none; /* remove shadow */
    padding: 1rem;
}

/* Use Bootstrap grid for layout (2-8-2). Left and right column styling intentionally minimal so Bootstrap handles spacing. */
/* Remove fixed sidebars; layout is now responsive using Bootstrap classes in the markup. */


.container-fluid {
    padding-left: 16px;
    padding-right: 16px;
    box-sizing: border-box;
}

@@media (max-width: 992px) {
    .container-fluid {
        padding-left: 16px !important;
        padding-right: 16px !important;
    }
}

.sidebar-link-highlight {
    background: linear-gradient(90deg,#FFD600,#FFB800);
    color: #111 !important;
    font-weight: 700;
    padding: 10px 12px;
    border-radius: 8px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    display: flex;
    align-items: center;
    gap: 8px;
    text-decoration: none;
    transition: transform 0.12s ease, box-shadow 0.12s ease;
    border: 1px solid rgba(0,0,0,0.04);
}

    /* Slight lift on hover/focus */
    .sidebar-link-highlight:hover,
    .sidebar-link-highlight:focus {
        transform: translateY(-2px);
        box-shadow: 0 12px 28px rgba(0,0,0,0.16);
        text-decoration: none;
    }

    /* Make icon slightly larger inside highlighted link */
    .sidebar-link-highlight .bi {
        font-size: 1.05rem;
    }

/* Ensure it stacks nicely on small screens */
@@media (max-width: 992px) {
    .sidebar-link-highlight {
        display: inline-flex;
        padding: 8px 10px;
        border-radius: 6px;
        box-shadow: none;
    }
}

.attention-wrapper {
    position: relative;
    padding-left: 44px; /* make room for the arrow */
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.attention-arrow {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    pointer-events: none;
    z-index: 5;
}

    .attention-arrow svg {
        width: 100%;
        height: 100%;
        fill: #111;
        filter: drop-shadow(0 6px 12px rgba(0,0,0,0.12));
        animation: arrow-bob 1.6s ease-in-out infinite;
        transform-origin: center;
    }

/* optional gentle pulse on the highlighted link */
.sidebar-link-highlight.attention-wrapper {
    box-shadow: 0 8px 20px rgba(255, 182, 0, 0.10);
    transition: box-shadow 0.18s ease, transform 0.12s ease;
}

@@keyframes arrow-bob {
    0% {
        transform: translateY(-50%) translateX(0) rotate(0deg);
    }

    25% {
        transform: translateY(-58%) translateX(2px) rotate(-6deg);
    }

    50% {
        transform: translateY(-50%) translateX(0) rotate(0deg);
    }

    75% {
        transform: translateY(-54%) translateX(1px) rotate(6deg);
    }

    100% {
        transform: translateY(-50%) translateX(0) rotate(0deg);
    }
}

/* Grid typography tweaks: smaller, no bold to reduce visual weight */
.card-body .table,
.grid-yellow-bg .table,
.table.table-sm {
    font-size: 0.88rem; /* slightly smaller than default */
}

.table thead th {
    font-size: 0.92rem;
    font-weight: 600; /* keep headers slightly emphasized but not overly bold */
}

.table tbody td,
.table tbody th {
    font-weight: 400 !important; /* remove bold in grid body */
    color: #222;
}

/* Neutralize utility bold classes inside the grid so markup doesn't force heavy weight */
.table .fw-bold,
.table .fw-semibold,
.table strong,
.table b {
    font-weight: 400 !important;
}

/* Tighten spacing a little so reduced font doesn't create too much white space */
.table td, .table th {
    padding: 0.45rem 0.5rem;
}

/* Simple Mode Styling */
.simple-mode .complex-column {
    display: none !important;
}

.simple-mode .table {
    font-size: 1rem;
}

.simple-mode .card-header {
    background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
    font-size: 1.1rem;
    border: none;
}

    .simple-mode .card-header .small {
        font-size: 0.9rem !important;
    }

/* Reduce tooltip overload in simple mode */
.simple-mode .info-tooltip {
    display: none;
}

.simple-mode .bi-info-circle {
    display: none;
}

/* Keep essential info icons in simple mode */
.simple-mode .essential-info {
    display: inline !important;
}

/* Modal backdrop and blur effect */
.intro-modal-active {
    /* Mobile: completely hide content */
    display: none;
}

/* Desktop/Laptop: show but blur */
@@media (min-width: 992px) {
    .intro-modal-active {
        display: block;
        filter: blur(8px);
        pointer-events: none;
        user-select: none;
        opacity: 0.6;
    }
}

/* Ensure modal backdrop is solid on mobile */
@@media (max-width: 991px) {
    .modal-backdrop {
        opacity: 1 !important;
        background-color: #fff !important;
    }
}

/* Make sure modal stays on top and centered */
.modal.d-block {
    display: flex !important;
    align-items: center;
    justify-content: center;
}

/* Mobile Card Layout - replaces table on small screens */
@@media (max-width: 767px) {
    /* Hide the table on mobile */
    .mobile-hide-table {
        display: none !important;
    }
    /* Show card layout on mobile */
    .mobile-card-layout {
        display: block !important;
    }
    /* Individual expense card styling */
    .expense-card {
        background: white;
        border: 1px solid rgba(255, 214, 0, 0.3);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .expense-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid #e9ecef;
    }

    .expense-card-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #222;
        flex: 1;
    }

    .expense-card-actions {
        display: flex;
        gap: 8px;
        flex-shrink: 0;
    }

    .expense-card-body {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 12px;
    }

    .expense-card-field {
        display: flex;
        flex-direction: column;
    }

    .expense-card-field-full {
        grid-column: 1 / -1;
    }

    .expense-card-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        color: #6c757d;
        font-weight: 600;
        margin-bottom: 4px;
        letter-spacing: 0.5px;
    }

    .expense-card-value {
        font-size: 1rem;
        color: #222;
        font-weight: 500;
    }

    .expense-card-value-large {
        font-size: 1.25rem;
        font-weight: 700;
        color: #0d6efd;
    }
    /* Action buttons in card */
    .expense-card-btn {
        min-width: 44px;
        min-height: 44px;
        padding: 12px;
        font-size: 1rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
}

/* Desktop: hide mobile card layout */
@@media (min-width: 768px) {
    .mobile-card-layout {
        display: none !important;
    }
}

/* Mobile Modal Improvements */
@@media (max-width: 575px) {
    /* Fullscreen modals on small screens */
    .modal-fullscreen-sm-down .modal-content {
        border-radius: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
    }

    .modal-fullscreen-sm-down .modal-body {
        flex: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .modal-fullscreen-sm-down .modal-header,
    .modal-fullscreen-sm-down .modal-footer {
        flex-shrink: 0;
    }
    /* Ensure form inputs are visible above keyboard */
    .modal-fullscreen-sm-down input:focus,
    .modal-fullscreen-sm-down select:focus,
    .modal-fullscreen-sm-down textarea:focus {
        scroll-margin-top: 100px;
    }
    /* Larger touch targets for modal buttons */
    .modal-footer .btn {
        min-height: 48px;
        padding: 12px 24px;
        font-size: 1rem;
    }
    /* Increase form input sizes on mobile */
    .modal-body .form-control,
    .modal-body .form-select {
        min-height: 48px;
        font-size: 1rem;
    }

    .modal-body .form-check-input {
        min-width: 24px;
        min-height: 24px;
    }
}

/* Ensure modal scrolls properly when keyboard is visible */
.modal-dialog-scrollable .modal-body {
    max-height: calc(100vh - 200px);
}

/* Touch Target Improvements - Minimum 44x44px for mobile */
@@media (max-width: 767px) {
    /* Info icons - larger tap area */
    .bi-info-circle {
        padding: 12px;
        margin: -12px;
        min-width: 44px;
        min-height: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    /* Close buttons in alerts/tooltips */
    .alert .btn-close,
    .alert .bi-x-lg {
        min-width: 44px;
        min-height: 44px;
        padding: 12px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    /* All buttons minimum size */
    .btn, button {
        min-height: 44px;
        padding: 10px 16px;
    }

    .btn-sm {
        min-height: 44px;
        padding: 10px 14px;
        font-size: 0.95rem;
    }
    /* Trash/delete buttons */
    .bi-trash-fill,
    .bi-trash {
        padding: 12px;
        min-width: 44px;
        min-height: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    /* Edit/pencil buttons */
    .bi-pencil-square,
    .bi-pencil {
        padding: 8px;
    }
    /* Category accordion header - make entire header tappable */
    .card-header {
        min-height: 60px;
        padding: 12px 16px;
    }
    /* Form checkboxes and radio buttons */
    .form-check-input {
        min-width: 28px;
        min-height: 28px;
        margin-top: 0;
    }

    .form-check-label {
        padding-left: 8px;
        min-height: 44px;
        display: inline-flex;
        align-items: center;
    }
    /* Checkbox labels clickable area */
    .form-check {
        min-height: 44px;
        display: flex;
        align-items: center;
        padding: 8px 0;
    }
    /* Tab navigation */
    .nav-link {
        min-height: 48px;
        padding: 12px 16px;
        display: flex;
        align-items: center;
    }
    /* Badge/link touch targets */
    .badge,
    a.badge {
        min-height: 36px;
        padding: 8px 12px;
        display: inline-flex;
        align-items: center;
    }
    /* Mode toggle switch */
    .form-switch .form-check-input {
        min-width: 48px;
        min-height: 28px;
    }
    /* Add category/item buttons */
    .btn-success,
    .btn-primary {
        min-height: 48px;
        font-size: 1rem;
    }
    /* Collapse/Expand all button */
    .btn-outline-secondary {
        min-height: 44px;
    }
}

/* Touch-friendly improvements for all screens */
/* Add visual feedback for touch */
@@media (hover: none) and (pointer: coarse) {
    /* These styles apply only to touch devices */
    button:active,
    .btn:active,
    a:active {
        transform: scale(0.98);
        transition: transform 0.1s;
    }
    /* Remove hover effects that don't work on touch */
    *:hover {
        /* Disable problematic hover states */
    }
    /* Larger tap targets for icon buttons */
    .bi {
        cursor: pointer;
    }
    /* Prevent accidental double-tap zoom */
    button,
    a,
    input,
    select,
    textarea {
        touch-action: manipulation;
    }
}

/* Responsive Layout Fixes for Mobile */
@@media (max-width: 767px) {
    /* Stack absolutely positioned elements */
    .tab-panel-box > .position-absolute {
        position: relative !important;
        top: auto !important;
        right: auto !important;
        left: auto !important;
        margin-bottom: 12px;
    }
        /* Mode toggle - full width on mobile */
        .tab-panel-box > .position-absolute:first-child {
            width: 100%;
        }

            .tab-panel-box > .position-absolute:first-child > div {
                width: 100%;
                justify-content: space-between;
            }
        /* Action buttons - full width stack */
        .tab-panel-box > .position-absolute:nth-child(2) {
            width: 100%;
        }

            .tab-panel-box > .position-absolute:nth-child(2).d-flex {
                flex-direction: column;
                gap: 8px !important;
            }

            .tab-panel-box > .position-absolute:nth-child(2) button {
                width: 100%;
            }
    /* Totals strip - stack vertically */
    .totals-strip {
        flex-direction: column !important;
        gap: 12px !important;
    }

    .totals-box {
        width: 100% !important;
        min-width: auto !important;
    }
    /* Make totals boxes clearly non-interactive */
    .totals-box {
        cursor: default !important;
        transition: none !important;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.12) !important;
    }

        .totals-box:hover {
            transform: none !important;
        }

        .totals-box:active {
            transform: none !important;
        }
    /* Category header - wrap content */
    .card-header {
        flex-wrap: wrap;
    }

        .card-header .small {
            display: block !important;
            width: 100%;
            margin-top: 8px;
        }
        /* Hide some less critical info on mobile */
        .card-header .text-muted.d-none.d-md-inline {
            display: none !important;
        }
    /* Assumptions section - stack vertically */
    .section-card .d-flex.flex-wrap {
        flex-direction: column;
        align-items: flex-start !important;
    }

    .section-card .me-4 {
        margin-right: 0 !important;
        margin-bottom: 8px;
    }
    /* Add category button center */
    .d-flex.justify-content-center.mb-3 {
        flex-direction: column;
    }
    /* Collapse all button - full width */
    .d-flex.align-items-center.mb-2 {
        flex-direction: column;
        align-items: stretch !important;
    }

        .d-flex.align-items-center.mb-2 button {
            width: 100%;
            margin-bottom: 8px;
        }
}

/* Tablet adjustments */
@@media (min-width: 768px) and (max-width: 991px) {
    /* Mode toggle - adjust position for tablet */
    .position-absolute[style*="right: 280px"] {
        right: 180px !important;
    }
}

/* Ensure tab panel content has proper spacing on mobile */
@@media (max-width: 767px) {
    .tab-panel-box {
        padding: 16px 12px !important;
    }
    /* Reduce top panel offset on mobile */
    .tab-panel-box {
        top: 0 !important;
    }
    /* Add some breathing room */
    .section-card,
    .card {
        margin-bottom: 16px;
    }
    /* Survey card on left - hide or stack */
    .col-md-2 {
        margin-bottom: 20px;
    }

    .survey-card {
        max-width: 100%;
        width: 100%;
    }
}

/* Accordion Header Mobile Optimization */
@@media (max-width: 767px) {
    /* Make accordion header more compact and stackable */
    .card-header.d-flex.align-items-center {
        flex-wrap: wrap;
        padding: 12px 8px !important;
        gap: 8px;
        align-items: flex-start !important;
    }
    /* Category name and remove button - first row */
    .card-header .btn-soft-danger {
        order: 1;
        padding: 4px 8px !important;
        min-width: 36px;
        flex-shrink: 0;
    }

    .card-header .me-2[style*="font-weight: bold"] {
        order: 2;
        flex: 1 1 auto;
        min-width: 0;
        max-width: calc(100% - 120px);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin-right: 8px !important;
        font-size: 1rem;
    }
    /* Category info icon - next to name */
    .card-header > .bi-info-circle:first-of-type {
        order: 3;
        flex-shrink: 0;
        font-size: 1rem !important;
        padding: 8px;
        margin: -8px;
    }
    /* Show totals on mobile - make them compact and wrap to new line */
    .card-header .small.text-muted {
        display: inline-block !important;
        order: 4;
        font-size: 0.75rem !important;
        margin-left: 44px !important; /* Align with category name after button */
        margin-right: 8px !important;
        flex: 0 0 auto;
    }
        /* Stack totals if needed */
        .card-header .small.text-muted:first-of-type {
            margin-left: 44px !important;
        }

        .card-header .small.text-muted:last-of-type {
            margin-left: 8px !important;
        }
    /* Compact total labels for mobile */
    .card-header .small.text-muted {
        white-space: nowrap;
    }
    /* Move action buttons to new row */
    .card-header .ms-auto {
        order: 5;
        margin-left: 0 !important;
        flex: 1 1 100%;
        margin-top: 8px;
        justify-content: space-between;
    }
        /* Make "Add Item" button more prominent on mobile */
        .card-header .ms-auto .btn-success {
            flex: 1;
            max-width: calc(100% - 40px);
        }
    /* Info icons - ensure adequate touch target */
    .card-header .bi-info-circle {
        font-size: 1.1rem !important;
        padding: 8px;
        margin: -8px;
    }
    /* Collapse indicator - add visual cue */
    .card-header::after {
        content: '';
        position: absolute;
        right: 8px;
        top: 16px;
        width: 0;
        height: 0;
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 8px solid currentColor;
        opacity: 0.5;
        transition: transform 0.2s ease;
    }

    .card-header[aria-expanded="true"]::after {
        transform: rotate(180deg);
    }
    /* Increase tap target size for entire header */
    .card-header {
        min-height: 66px;
        position: relative;
    }
        /* Ensure buttons stay clickable despite header onclick */
        .card-header button,
        .card-header .bi-info-circle {
            position: relative;
            z-index: 2;
        }
}

/* Tablet - show some totals but keep compact */
@@media (min-width: 768px) and (max-width: 991px) {
    .card-header .small.text-muted {
        font-size: 0.7rem !important;
    }

    .card-header .ms-auto .btn-success {
        font-size: 0.8rem;
        padding: 0.25rem 0.5rem;
    }
}

/* Tab Navigation Mobile Optimization */
@@media (max-width: 767px) {
    /* Make tab container horizontally scrollable */
    .nav-tabs {
        flex-wrap: nowrap !important;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        scrollbar-width: thin; /* Firefox */
        padding-bottom: 8px;
        margin-bottom: 8px !important;
    }
        /* Webkit scrollbar styling */
        .nav-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .nav-tabs::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 2px;
        }

        .nav-tabs::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 2px;
        }

            .nav-tabs::-webkit-scrollbar-thumb:hover {
                background: #555;
            }
        /* Prevent tabs from shrinking */
        .nav-tabs .nav-item {
            flex-shrink: 0;
            white-space: nowrap;
        }
        /* Make tab buttons more touch-friendly */
        .nav-tabs .nav-link {
            min-height: 44px;
            padding: 10px 16px !important;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }
    /* Info icon next to tab */
    .nav-item .bi-info-circle {
        font-size: 1rem !important;
        padding: 8px;
        margin: -8px 0 -8px 4px;
    }
    /* Add visual hint that tabs are scrollable */
    .nav-tabs::after {
        content: '?';
        position: sticky;
        right: 0;
        background: linear-gradient(to right, transparent, white 30%);
        padding: 0 12px 0 24px;
        pointer-events: none;
        font-size: 1.2rem;
        color: #6c757d;
        display: flex;
        align-items: center;
    }
    /* Hide scroll hint when at end */
    .nav-tabs.scrolled-to-end::after {
        content: '';
    }
}

/* Small mobile - even more compact tabs */
@@media (max-width: 575px) {
    .nav-tabs .nav-link {
        padding: 8px 12px !important;
        font-size: 0.85rem;
    }
}

/* Font Size and Text Density Mobile Optimization */
@@media (max-width: 767px) {
    /* Base font size - slightly larger for better readability */
    body {
        font-size: 16px; /* Prevents iOS auto-zoom on input focus */
    }
    /* Headings - proportionally scaled */
    h1 {
        font-size: 1.75rem !important;
        line-height: 1.2;
    }

    h2 {
        font-size: 1.5rem !important;
        line-height: 1.3;
    }

    h3 {
        font-size: 1.25rem !important;
        line-height: 1.3;
    }

    h4 {
        font-size: 1.1rem !important;
        line-height: 1.4;
    }

    h5, h6 {
        font-size: 1rem !important;
        line-height: 1.4;
    }
    /* Buttons - readable text */
    .btn {
        font-size: 0.9rem !important;
        line-height: 1.4;
    }

    .btn-sm {
        font-size: 0.85rem !important;
    }

    .btn-lg {
        font-size: 1rem !important;
    }
    /* Form labels and inputs */
    label {
        font-size: 0.95rem !important;
        margin-bottom: 6px;
    }

    input, select, textarea {
        font-size: 16px !important; /* Prevents iOS zoom */
        line-height: 1.5;
    }
    /* Small text - but not too small */
    .small, small {
        font-size: 0.85rem !important;
        line-height: 1.4;
    }
    /* Alert messages */
    .alert {
        font-size: 0.9rem !important;
        line-height: 1.5;
    }
    /* Card text */
    .card-body {
        font-size: 0.95rem;
        line-height: 1.5;
    }
    /* Expense card - readable amounts */
    .expense-card .expense-label {
        font-size: 0.9rem !important;
    }

    .expense-card .expense-value {
        font-size: 1rem !important;
        font-weight: 600;
    }

    .expense-card .expense-total {
        font-size: 1.1rem !important;
        font-weight: bold;
    }
    /* Table text in modals */
    .modal-body table {
        font-size: 0.85rem;
    }

    .modal-body th {
        font-size: 0.8rem;
        line-height: 1.3;
    }
    /* Totals strip - prominent numbers */
    .totals-box strong,
    .totals-box .fw-bold {
        font-size: 1.1rem !important;
    }

    .totals-box .small {
        font-size: 0.8rem !important;
    }
    /* Category header text */
    .card-header {
        font-size: 0.95rem;
        line-height: 1.4;
    }

        .card-header .small {
            font-size: 0.75rem !important;
        }
    /* Assumptions section */
    .section-card {
        font-size: 0.9rem;
    }

        .section-card .small {
            font-size: 0.8rem !important;
        }
    /* Info tooltips and help text */
    .text-muted {
        font-size: 0.85rem !important;
    }
    /* Badge and pills */
    .badge {
        font-size: 0.8rem !important;
        padding: 0.35em 0.65em;
    }
    /* Reduce line spacing for compact layouts */
    p {
        margin-bottom: 0.75rem;
    }
    /* List spacing */
    ul, ol {
        margin-bottom: 0.75rem;
    }

    li {
        margin-bottom: 0.25rem;
    }
}

/* Very small screens - tighten up further */
@@media (max-width: 575px) {
    h1 {
        font-size: 1.5rem !important;
    }

    h2 {
        font-size: 1.35rem !important;
    }

    .card-header {
        font-size: 0.9rem;
    }

    .expense-card {
        font-size: 0.85rem;
    }
}

/* Improve readability with better spacing */
@@media (max-width: 767px) {
    /* Add breathing room between sections */
    .section-card,
    .card {
        margin-bottom: 1rem;
    }
    /* Input spacing for better touch */
    .form-group,
    .mb-3 {
        margin-bottom: 1rem !important;
    }
    /* Button spacing */
    .btn {
        margin-bottom: 0.5rem;
    }
    /* Adequate padding in containers */
    .card-body {
        padding: 1rem !important;
    }

    .modal-body {
        padding: 1rem !important;
    }
}

/* Form Input Spacing for Mobile Keyboard Visibility */
@@media (max-width: 767px) {
    /* Ensure modals with forms have proper spacing */
    .modal-body form,
    .modal-body .form-group {
        margin-bottom: 1.5rem !important;
    }
        /* Last form element needs extra bottom padding */
        .modal-body form > *:last-child,
        .modal-body .form-group:last-of-type {
            margin-bottom: 2rem !important;
        }
    /* Input fields - adequate height and spacing */
    .form-control,
    .form-select {
        min-height: 44px; /* Touch target minimum */
        padding: 0.5rem 0.75rem;
        margin-bottom: 0.75rem;
    }
    /* Labels above inputs need space */
    label {
        display: block;
        margin-bottom: 0.5rem;
    }
    /* Form groups need vertical space */
    .row > [class*="col-"] {
        margin-bottom: 1rem;
    }
    /* Modal footer buttons - ensure visibility above keyboard */
    .modal-footer {
        padding: 1rem !important;
        gap: 0.5rem;
        position: sticky;
        bottom: 0;
        background: white;
        border-top: 1px solid #dee2e6;
        z-index: 10;
    }
        /* Full-width footer buttons on mobile */
        .modal-footer .btn {
            flex: 1;
            min-width: 100px;
        }
    /* Stack footer buttons if too many */
    .modal-footer {
        flex-wrap: wrap;
    }
    /* Add extra padding at bottom of modal body */
    .modal-body {
        padding-bottom: 2rem !important;
    }
    /* Scrollable modal body with proper height */
    .modal-dialog-scrollable .modal-body {
        max-height: calc(100vh - 200px); /* Leave room for header/footer */
        overflow-y: auto;
    }
    /* Input groups - ensure components align properly */
    .input-group {
        margin-bottom: 1rem;
    }

        .input-group > .form-control,
        .input-group > .form-select {
            margin-bottom: 0;
        }
    /* Inline form elements need spacing */
    .form-inline .form-control,
    .form-inline .form-select {
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
    }
    /* Checkboxes and radios - better touch targets */
    .form-check {
        min-height: 44px;
        display: flex;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .form-check-input {
        width: 20px;
        height: 20px;
        margin-top: 0;
        margin-right: 0.5rem;
    }

    .form-check-label {
        margin-bottom: 0;
        padding-left: 0.25rem;
    }
    /* Help text below inputs */
    .form-text,
    .invalid-feedback,
    .valid-feedback {
        font-size: 0.85rem;
        margin-top: 0.25rem;
        margin-bottom: 0.5rem;
    }
    /* Ensure textarea has adequate height */
    textarea.form-control {
        min-height: 88px; /* At least 2 lines visible */
    }
    /* Number inputs - larger tap targets for +/- */
    input[type="number"] {
        -webkit-appearance: none;
        -moz-appearance: textfield;
    }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    /* Date/time inputs */
    input[type="date"],
    input[type="time"],
    input[type="datetime-local"] {
        min-height: 44px;
    }
    /* Validation states - visible indicators */
    .was-validated .form-control:invalid,
    .form-control.is-invalid {
        border-width: 2px;
        padding-right: calc(1.5em + 0.75rem);
    }

    .was-validated .form-control:valid,
    .form-control.is-valid {
        border-width: 2px;
        padding-right: calc(1.5em + 0.75rem);
    }
}

/* Handle forms in cards (not modals) */
@@media (max-width: 767px) {
    .card-body form {
        padding: 0.5rem 0;
    }

    .card-body .form-group {
        margin-bottom: 1.25rem;
    }
    /* Assumptions form specifically */
    .section-card form .form-control,
    .section-card form .form-select {
        margin-bottom: 0.5rem;
    }
}

/* Prevent keyboard from hiding submit buttons */
@@media (max-width: 767px) {
    /* When input is focused, ensure submit button is visible */
    .modal-footer {
        /* Sticky positioning keeps it visible */
        position: sticky;
        bottom: 0;
        background: white;
        box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
    }
    /* Add safe area for iOS notch/home indicator */
    .modal-footer {
        padding-bottom: max(1rem, env(safe-area-inset-bottom)) !important;
    }

    .modal-body {
        padding-bottom: max(2rem, calc(2rem + env(safe-area-inset-bottom))) !important;
    }
}

/* Mobile responsive styles - hide sidebar ads on mobile */
@media (max-width: 767px) {
    /* Hide left and right sidebar ads on mobile */
    .col-12.col-md-2 {
        display: none !important;
    }

    /* Make main content full width when sidebars are hidden */
    .col-12.col-md-8 {
        flex: 0 0 100%;
        max-width: 100%;
    }
}

/* Text Truncation with Ellipsis for Long Names */
@@media (max-width: 767px) {
    /* Category names in accordion headers */
    .card-header span[style*="font-weight: bold"] {
        max-width: calc(100% - 100px); /* Leave room for buttons/icons */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
        vertical-align: middle;
    }
    /* Expense item names in cards */
    .expense-card .expense-label {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
    }
    /* Item names in mobile card layout */
    .mobile-card-layout .expense-name,
    .mobile-card-layout strong {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
    }
    /* Tab labels - truncate if very long */
    .nav-tabs .nav-link {
        max-width: 200px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    /* Assumptions section labels */
    .section-card .form-label,
    .section-card label {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    /* Modal titles */
    .modal-title {
        max-width: calc(100% - 40px); /* Leave room for close button */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    /* Table cell content in modals */
    .modal-body td,
    .modal-body th {
        max-width: 150px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
        /* Allow wrapping for certain columns if needed */
        .modal-body td:first-child,
        .modal-body th:first-child {
            max-width: 120px;
        }
    /* Totals strip labels */
    .totals-box .small {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 100%;
    }
    /* Button text - truncate if too long */
    .btn {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    /* Alert messages - allow wrapping but control long words */
    .alert {
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
    }
    /* Form control values */
    .form-control,
    .form-select {
        text-overflow: ellipsis;
    }
    /* Breadcrumbs if present */
    .breadcrumb-item {
        max-width: 150px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    /* Badge content */
    .badge {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
    }
    /* List items */
    li {
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    /* Links */
    a {
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    /* Code blocks or pre-formatted text */
    code, pre {
        max-width: 100%;
        overflow-x: auto;
        word-wrap: break-word;
        white-space: pre-wrap;
    }
    /* Prevent URLs from breaking layout */
    .form-text,
    .small,
    small {
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
}

/* Multi-line truncation for specific elements */
@@media (max-width: 767px) {
    /* Allow 2-line truncation for descriptions */
    .expense-card .expense-description,
    .card-text {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        max-height: 3em; /* 2 lines at 1.5 line-height */
    }
    /* Info tooltips - allow 3 lines */
    .tooltip-inner {
        max-width: 280px;
        white-space: normal;
        text-align: left;
    }
    /* Popover content */
    .popover-body {
        max-width: 280px;
        word-wrap: break-word;
    }
}

/* Add title attribute for truncated text (accessibility) */
@@media (max-width: 767px) {
    /* Ensure truncated elements show full text on long press/hover */
    [style*="text-overflow: ellipsis"],
    .text-truncate {
        cursor: help;
    }
}

/* Very small screens - tighter truncation */
@@media (max-width: 575px) {
    .nav-tabs .nav-link {
        max-width: 150px;
    }

    .modal-body td,
    .modal-body th {
        max-width: 100px;
    }

    .breadcrumb-item {
        max-width: 100px;
    }

    .card-header span[style*="font-weight: bold"] {
        max-width: calc(100% - 80px);
    }
}

/* Additional Mobile Refinements - Polish & UX Enhancements */

/* Touch Feedback & Visual Response */
@@media (max-width: 767px) {
    /* Add active state feedback for touch */
    .btn:active,
    .nav-link:active,
    .card-header:active {
        transform: scale(0.98);
        transition: transform 0.1s ease;
    }
    /* Highlight tapped items */
    .list-group-item:active,
    .dropdown-item:active {
        background-color: rgba(0, 123, 255, 0.1);
    }
    /* Card interaction feedback */
    .card:active {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }
    /* Link tap highlight */
    a:active {
        opacity: 0.7;
    }
    /* Remove default tap highlight color */
    * {
        -webkit-tap-highlight-color: rgba(0, 123, 255, 0.1);
        -webkit-touch-callout: none;
    }
    /* Button ripple effect simulation */
    .btn-primary:active,
    .btn-success:active,
    .btn-danger:active {
        box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
    }
}

/* Dropdown Menu Optimizations */
@@media (max-width: 767px) {
    /* Full-width dropdowns on mobile */
    .dropdown-menu {
        width: 100%;
        max-width: 100vw;
        left: 0 !important;
        right: 0 !important;
        border-radius: 0.25rem;
    }
    /* Larger dropdown items for touch */
    .dropdown-item {
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
        min-height: 44px;
        display: flex;
        align-items: center;
    }
    /* Dropdown dividers more visible */
    .dropdown-divider {
        margin: 0.5rem 0;
        border-top-width: 2px;
    }
    /* Dropdown header styling */
    .dropdown-header {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        font-weight: 600;
        color: #6c757d;
    }
    /* Scrollable dropdown if too many items */
    .dropdown-menu {
        max-height: 70vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }
}

/* Sticky Positioning Adjustments */
@@media (max-width: 767px) {
    /* Sticky totals strip */
    .totals-strip {
        position: sticky;
        top: 0;
        z-index: 100;
        background: white;
        padding: 0.75rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 1rem;
    }
    /* Sticky tab navigation */
    .nav-tabs {
        position: sticky;
        top: 0;
        z-index: 99;
        background: white;
        padding-top: 0.5rem;
        margin-top: -0.5rem;
    }
    /* Ensure sticky elements don't overlap */
    .sticky-top {
        z-index: 98;
    }
    /* Add subtle separator under sticky elements */
    .totals-strip::after,
    .nav-tabs::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(to right, transparent, #dee2e6 10%, #dee2e6 90%, transparent);
    }
}

/* Loading States & Animations */
@@media (max-width: 767px) {
    /* Smooth transitions */
    .card,
    .modal,
    .alert {
        transition: all 0.2s ease-in-out;
    }
    /* Fade in animations */
    @@keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .card,
    .expense-card {
        animation: fadeIn 0.3s ease-out;
    }
    /* Loading spinner size */
    .spinner-border,
    .spinner-grow {
        width: 2rem;
        height: 2rem;
    }

    .spinner-border-sm,
    .spinner-grow-sm {
        width: 1rem;
        height: 1rem;
    }
    /* Disabled state clarity */
    .btn:disabled,
    .btn.disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    /* Progress bars */
    .progress {
        height: 1.5rem;
        border-radius: 0.5rem;
    }
}

/* Accessibility Enhancements */
@@media (max-width: 767px) {
    /* Focus indicators for keyboard navigation */
    *:focus-visible {
        outline: 3px solid #0d6efd;
        outline-offset: 2px;
    }
    /* Skip to content link */
    .skip-to-content {
        position: absolute;
        top: -40px;
        left: 0;
        background: #0d6efd;
        color: white;
        padding: 8px 16px;
        z-index: 9999;
    }

        .skip-to-content:focus {
            top: 0;
        }
    /* Screen reader only text */
    .sr-only,
    .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }
    /* High contrast mode support */
    @@media (prefers-contrast: high) {
        .btn {
            border-width: 2px;
        }

        .card {
            border-width: 2px;
        }
    }
    /* Reduced motion support */
    @@media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
    }
}

/* Performance Optimizations */
@@media (max-width: 767px) {
    /* Hardware acceleration for animations */
    .card,
    .modal,
    .btn,
    .nav-link {
        transform: translateZ(0);
        will-change: transform;
    }
    /* Optimize repaints */
    .card-header,
    .modal-header,
    .modal-footer {
        contain: layout style;
    }
    /* Lazy load images if present */
    img {
        loading: lazy;
    }
}

/* Safe Area & Notch Handling */
@@media (max-width: 767px) {
    /* iOS safe areas */
    body {
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }
    /* Top safe area */
    .top-strip,
    .navbar {
        padding-top: max(0.5rem, env(safe-area-inset-top));
    }
    /* Bottom safe area for footers */
    footer,
    .bottom-nav {
        padding-bottom: env(safe-area-inset-bottom);
    }
}

/* Print Styles */
@@media print {
    /* Hide navigation on print */
    .nav-tabs,
    .navbar,
    .btn,
    .modal {
        display: none !important;
    }
    /* Expand all accordions */
    .collapse {
        display: block !important;
    }
    /* Remove backgrounds */
    .card,
    .card-body {
        background: white !important;
        border: 1px solid #dee2e6 !important;
    }
    /* Better page breaks */
    .card,
    .expense-card {
        page-break-inside: avoid;
    }
}

/* Dark Mode Support (if implemented later) */
@@media (prefers-color-scheme: dark) {
    /* Placeholder for future dark mode */
    /* .card {
                                    background: #1e1e1e;
                                    color: #ffffff;
                                } */
}

/* Landscape Orientation Adjustments */
@@media (max-width: 767px) and (orientation: landscape) {
    /* Reduce vertical spacing in landscape */
    .modal-body {
        padding: 0.75rem !important;
    }

    .form-group,
    .mb-3 {
        margin-bottom: 0.5rem !important;
    }
    /* Compact headers in landscape */
    .card-header {
        padding: 8px 6px !important;
        min-height: 48px;
    }
    /* Smaller modals in landscape */
    .modal-dialog {
        max-height: 90vh;
    }
}

.totals-strip {
    width: 100%;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

.totals-box {
    min-width: 180px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    border: 1.5px solid #e3e3e3;
    transition: box-shadow 0.2s;
}

.totals-label {
    font-size: 1rem;
    font-weight: 500;
    opacity: 0.92;
    letter-spacing: 0.01em;
}

.totals-value {
    font-size: 1.08rem;
    font-weight: 700;
    letter-spacing: 0.01em;
    margin-top: 2px;
}
